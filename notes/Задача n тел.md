## Постановка
Пусть существует N частиц, представляемых материальными точками с массами $m_1, ..., m_N$  и радиус векторами $\vec{r_1}, ..., \vec{r_N}$. Попарное взаимойдействие точек подчинено закону тяготения ньютона:
$$\vec{F}_{jk} = G\hat{\vec{r_{jk}}}\frac{m_km_j}{\vec{r_{jk}}^2} $$
где, 
- $\vec{F_{jk}}$ - сила, действующая на k-ая частица j-ю;
- $\vec{r_{jk}} = \vec{r_j} - \vec{r_k}$ - вектор из точки j-ой частицы в точку j-ой;
- $\hat{\vec{r_{jk}}}$ - единичный вектор, задающий направление силы;
- $m_k, m_j$ - массы k-ой и j-oй частиц соответсвенно;
- $G = 6.6473 * 10^{-11}$ - гравитационная постоянная
При этом данные силы аддитивны. Пусть также известны начальные положения $\vec{r_{0k}}$ и скорости $\vec{v_{0k}}$ всех частиц в момент времени $t=0$. Требуется найти все положения тел в последующие моменты времени.\

Так как силы аддитивны, том суммарную силу, действующую на k-ю частицу можно описать так:
$$\vec{F}_{k} = Gm_k\sum_{j=0}^{j<N, (j \neq k)}\hat{\vec{r_{jk}}}\frac{m_j}{\vec{r_{jk}}^2}$$
По второму закону Ньютона:
$$\frac{\delta^2{\vec{r_k}}}{\delta{t^2}} = G\sum_{j=0}^{j<N, (j \neq k)}\hat{\vec{r_{jk}}}\frac{m_j}{\vec{r_{jk}}^2}, k=1,...,N$$
Полученное систему дифференциальных уравнений 2-го порядка можно свести к системе уравнений 1-го порядка введдением новых переменных - скоростей:
$$\frac{d\vec{r_k}}{dt} = \vec{v_k}, k = 1,...,N$$
$$\frac{d\vec{v_k}}{dt} = G\sum_{j=0}^{j<N, (j \neq k)}\hat{\vec{r_{jk}}}\frac{m_j}{\vec{r_{jk}}^2}, k=1,...,N$$

Так как каждый вектор 3-х компонетный, то получается система из 6N неизветсных.
В дальнейшем систему будет записывать в векторном виде:
$$\vec(y)'(t) = \vec{g}(t, \vec{y}), где$$
$$y(t)=[\vec{r_1},...\vec{r_N}, \vec{v_1},..., \vec{v_N}],$$
$$\vec{g}(t, \vec{y}) = [\vec{v_1},..., \vec{v_N}, \vec{f_1},...\vec{f_N}], а\ f_k = G\sum_{j=0}^{j<N, (j \neq k)}\hat{\vec{r_{jk}}}\frac{m_j}{\vec{r_{jk}}^2}, k=1,...,N$$
## Численные методы решения
В численных метода будем отталкиваться от какой-либо начальной точки ($t_0, y_0$) с определённым шагом по t - $h$.
### Явный Метод Эйлера
**Порядок точности:** 1
Метод эйлера - численный метод решения ОДУ первого порядка, является одношаговым и имеет первый порядок точности. Метод эйлера аппроксимирует решение простой идей - изменять значения по производной по множенной на шаг, то есть:
$$\vec{y_{k+1}} = \vec{y_{k}}+ h * \vec{g(t_k, y_k)}$$
### Неявный метод эйлера
**Порядок точности:** 1
В отличие от явного метода, в неявном используется новое значение для y в обоих частях уравнения:
$$\vec{y_{k+1}} = \vec{y_{k}} + h*\vec{g(t_{k+1}, y_{k+1})}$$
Для решения таким способом требуются дополнительные вычислительные затраты на решение уравнения, например методом фиксированных точек, или методом Ньютона.
### "Классический метод" Рунге-Кутты(4-го порядка)
**Порядок точности:** 4
Семейство методов решения дифференциальных уравнений являются одними из самых часто применяемых методов численного интегрирования. Фактически методы Рунге-Кутты выходят из метода Эйлера, так как он является его частным случаем, а Рунге уже сформулировал общую схему метода Рунге-Кутты. При этом для вычисления  методов Рунге-Кутты выше 4-го порядка требуется больше шагов, чем значение точности, поэтому классическим считается именно Рунге-Кутте 4-го порядка. Метод выглядит так:
$$\vec{y_{k+1}} = \vec{y_{k}} + \frac{h}{6}(K_1 + K_2 + K_3 + K_4),\ где$$
$$\vec{K_1} = g(t_k, \vec{r_k})$$
$$\vec{K_2} = g(t_k + \frac{h}{2}, \vec{r_k} + h\frac{\vec{K_1}}{2})$$
$$\vec{K_3} = g(t_k + \frac{h}{2}, \vec{r_k} + h\frac{\vec{K_2}}{2})$$
$$\vec{K_4} = g(t_k + h, \vec{r_k} + \vec{K_3})$$
Существуют также другие схемы для 4-го порядка Рунге-Кутты, но как сам Кутте отмечал, "данное приближение можно рассматривать как лучшее в общем случае"

## Двухшаговый Метод адамса
**Порядок точности:** 2
Метод адамса в отличие от предыдущих методов является многошаговым, то есть для очередной итерации расчёта использует несколько последних значений, в частности в случае второго порядка используются два последних значения. Формула имеет вид:
$$\vec{y}_{k+1} = \vec{y}_{k} + h(\frac{3}{2}\vec{g}(t_k, y_k) - \frac{1}{2}\vec{g}(t_{k -1}, y_{k - 1}))$$
При этом для вычисления первого шага, когда неизвестно два значения предыдущих, можно использовать метод эйлера:
$$\vec{y_{k+1}} = \vec{y_{k}}+ h * \vec{g(t_k, y_k)}$$
### Метод Leapfrog
**Порядок точности:** 2
Предыдущие методы подходят для решения любых дифференциальных уравнений, данный же метод подходит специально для решения ДУ вида:
$$\frac{d^2x}{dt^2} = A(x)\ или\ \frac{dv}{dt} = A(x), \frac{dx}{dt} = v $$
Основная идея заключается в замене в методе эйлера скоростей на скорости между вычисляемыми позициями, что потенциально может дать нам повышенную точность.
Тогда рассчёт скорости и позиции проводится следующим образом:
$$\vec{v}_{k+\frac{1}{2}} = \vec{v}_{k-\frac{1}{2}} + hf_k(\vec{r}_k)$$
$$\vec{r}_{k+1} = \vec{r}_k + h*\vec{v}_{k+\frac{1}{2}}$$
При этом начальное приближение скорости считаем методом эйлера:
$$v_{\frac{1}{2}} = v_0 + \frac{h}{2}\vec{f}(\vec{r_0})$$

### Скоростной метод Верле
**Порядок точности:** 2
У предыдущего метода, несмотря на то, что он считается методом второго порядка точности, имеет недостаток в том, что начальная аппроксимация скорости имеет первый порядок точности, так как используется метод эйлера.
Ещё одной его проблемой можно выделить, что на очередном этапе для вычисления значения скорости, например для расчёта энергии частиц, потребуются дополнительные действия. Скоростной алгоритм Верле решает эти вопросы рассчитывая на каждом этапе и скорость и координаты методом средней точки. Итерацию этого алгоритма можно рассчитать так:
$$\vec{v}_{k+\frac{1}{2}} = \vec{v}_{k} + \frac{h}{2}f_k(\vec{r}_k)$$
$$\vec{r}_{k+1} = \vec{r}_k + h*\vec{v}_{k+\frac{1}{2}}$$
$$\vec{v}_{k+1} = \vec{v}_{k+\frac{1}{2}} + \frac{h}{2}f_k(\vec{r}_{k+1})$$
